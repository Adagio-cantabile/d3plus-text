!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("d3-selection")):"function"==typeof define&&define.amd?define("d3plus-text",["exports","d3-selection"],n):n(t.d3plus_text={},t.d3_selection)}(this,function(t,n){"use strict";function e(t){return function(){return t}}function r(t){if(t.includes(" ")){var n=t.split(/\s+/);return t.replace(" "+n[n.length-1],"...")}return"..."}function o(t){return t.match(l)}function i(){function t(){function t(t){t.attr("x",j+"px").attr("dx","0px").attr("dy",x+"px").attr("dominant-baseline","alphabetic").style("baseline-shift","0%")}function e(r){var i=v+r,u=w.html(),f=b.charAt(i.length);if(w.html(u+r),a.node().getBBox().height>o){if(w.remove(),w=n.select(a.node().lastChild),w.size()){b=w.html();var l=s(b);w.html(l?l:b)}return!1}if(w.node().getComputedTextLength()>z)return w.html(u.trimRight()),w=a.append("tspan").call(t),y++,e(r);var c=" "===f?" ":"";return v=i+c,w.html(u+r+c),!0}var r=f(),o=p(a),y=1,x=l(),v="",b=c(a),z=g(a),j=d(a);a.attr("y",m(a)+"px").attr("fill",i()).attr("font-family",u()).attr("font-size",r+"px").size("font-size",r+"px");var w=a.html("").append("tspan").call(t),C=!0,B=!1,F=void 0;try{for(var R,S=h(b)[Symbol.iterator]();!(C=(R=S.next()).done);C=!0){var _=R.value,k=e(_);if(!k)break}}catch(q){B=!0,F=q}finally{try{!C&&S["return"]&&S["return"]()}finally{if(B)throw F}}}var i,u,f,l,a,c,s=r,p=e(200),h=o,g=e(200),d=e(0),m=e(0);return t.ellipsis=function(n){return arguments.length?(s="function"==typeof n?n:e(n),t):s},t.fontColor=function(n){return arguments.length?(i="function"==typeof n?n:e(n),t):i},t.fontFamily=function(n){return arguments.length?(u="function"==typeof n?n:e(n),t):u},t.fontSize=function(n){return arguments.length?(f="function"==typeof n?n:e(n),t):f},t.height=function(n){return arguments.length?(p="function"==typeof n?n:e(n),t):p},t.select=function(r){return arguments.length?(a=n.select(r),void 0===c&&(c=e(a.text()),void 0===i&&(i=e(a.style("font-color"))),void 0===u&&(u=e(a.style("font-family"))),void 0===f&&(f=e(parseFloat(a.style("font-size"),10)),l=e(Math.ceil(1.1*f())))),t):a},t.split=function(n){return arguments.length?(h=n,t):h},t.text=function(n){return arguments.length?(c="function"==typeof n?n:e(n),t):c},t.width=function(n){return arguments.length?(g="function"==typeof n?n:e(n),t):g},t.x=function(n){return arguments.length?(d="function"==typeof n?n:e(n),t):d},t.y=function(n){return arguments.length?(m="function"==typeof n?n:e(n),t):m},t}var u="0.2.0",f=["-","/",";",":","&"],l=new RegExp("[^\\s\\"+f.join("\\")+"]+\\"+f.join("?\\")+"?","g");t.version=u,t.box=i});